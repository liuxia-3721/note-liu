<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .s_box{
            width: 300px;
            height: 200px;
            position: absolute;
            top: 20px;
            left: 50px;
        }
        .s_box img{
            width: 300px;
            height: 200px;
        }
        .s_box span{
            position: absolute;
            width: 60px;
            height: 40px;
            background: rgb(200, 200, 200,0.6);
            top: 0;
            left: 0;
            display: none;
        }
        .b_box{
            width: 300px;
            height: 200px;
            position: absolute;
            left: 380px;
            top: 20px;
            overflow: hidden;
            display: none;
        }
        .b_box img{
            width: 1500px;
            height: 1000px;
            position: absolute;
        }
    </style>
</head>
<body>
    <div class="s_box">
        <img src="../名侦探柯南/ke3.jpg" alt="" />
        <span></span>
    </div>
    
    <div class="b_box">
        <img src="../名侦探柯南/ke3.jpg" alt="" />
    </div>
</body>
<script>
    var oSbox=document.querySelector(".s_box");
    var oBbox=document.querySelector(".b_box");
    var ospan=document.querySelector(".s_box span");
    var oimg=document.querySelector(".b_box img");

    oSbox.onmouseover=function(){
        ospan.style.display="block";
        oBbox.style.display="block";

        oSbox.onmousemove=function(eve){
            var e=eve||window.event;
            var l=e.clientX-(ospan.offsetWidth)/2-oSbox.offsetLeft;
            var t=e.clientY-(ospan.offsetWidth)/2-oSbox.offsetTop;
            // var l=e.offsetX-(ospan.offsetWidth)/2;
            // var t=e.offsetY-(ospan.offsetHeight)/2; 存在冒泡, 需要用一个元素将ospan遮住
            if(l<=0){
                l=0;
            }
            if(t<=0){
                t=0;
            }
            if(l>=oSbox.offsetWidth-ospan.offsetWidth){
                l=oSbox.offsetWidth-ospan.offsetWidth;
                console.log(1)
            }
            if(t>=oSbox.offsetHeight-ospan.offsetHeight){
                t=oSbox.offsetHeight-ospan.offsetHeight
            }
            ospan.style.left=l+"px";
            ospan.style.top=t+"px";
            var bl=(oimg.offsetWidth-oBbox.offsetWidth)*(-l/(oSbox.offsetWidth-ospan.offsetWidth));
            console.log(l/(oSbox.offsetWidth-ospan.offsetWidth))
            var bt=(oimg.offsetHeight-oBbox.offsetHeight)*(-t/(oSbox.offsetHeight-ospan.offsetHeight));
            oimg.style.left=bl+"px";
            oimg.style.top=bt+"px";
        }
    }
    oSbox.onmouseout=function(){
        ospan.style.display="none";
        oBbox.style.display="none";
    }
</script>
</html>